[2025-02-19 04:13:29 +0300] [163145] [INFO] Starting gunicorn 23.0.0
[2025-02-19 04:13:29 +0300] [163145] [INFO] Listening at: http://0.0.0.0:5000 (163145)
[2025-02-19 04:13:29 +0300] [163145] [INFO] Using worker: sync
[2025-02-19 04:13:29 +0300] [163146] [INFO] Booting worker with pid: 163146
[2025-02-19 04:13:29 +0300] [163147] [INFO] Booting worker with pid: 163147
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00124s] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("master_service_association")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("clients")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("appointments")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("services")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("masters")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("specializations")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schedules")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("users")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002245s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.004074s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.00579s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006489s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008207s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01031s ago] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01212s ago] ('Мужская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01391s ago] ('Женская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01467s ago] ('Окрашивание волос', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01656s ago] ('Бритье', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01833s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02002s ago] ('Чистка лица', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02064s ago] ('Пилинг', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0224s ago] ('Наращивание ресниц', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0241s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02468s ago] ('Маникюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02638s ago] ('Педикюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02813s ago] ('Дизайн ногтей', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02984s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03052s ago] ('SPA-массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03225s ago] ('Антицеллюлитный массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03393s ago] ('Ароматерапия', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03453s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03622s ago] ('Восковая эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03794s ago] ('Лазерная эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03862s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04042s ago] ('Вечерний макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04215s ago] ('Свадебный макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00123s] ('Иван Петров', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('Мужская стрижка', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.003418s ago] ('Бритье', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008017s ago] ('Ольга Сидорова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006169s ago] ('Женская стрижка', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007992s ago] ('Окрашивание волос', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01349s ago] ('Анна Иванова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01137s ago] ('Маникюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01203s ago] ('Педикюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01377s ago] ('Дизайн ногтей', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01556s ago] ('Вечерний макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01734s ago] ('Свадебный макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02181s ago] ('Мария Кузнецова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01982s ago] ('Наращивание ресниц', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02164s ago] ('Коррекция бровей', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02602s ago] ('Александр Смирнов', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02396s ago] ('SPA-массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0257s ago] ('Антицеллюлитный массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03112s ago] ('Ирина Смирнова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02802s ago] ('Мужская стрижка', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02974s ago] ('Антицеллюлитный массаж', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03142s ago] ('Чистка лица', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03584s ago] ('Елена Аксенова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0338s ago] ('Чистка лица', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03549s ago] ('Пилинг', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03614s ago] ('Ароматерапия', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03787s ago] ('Восковая эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03958s ago] ('Лазерная эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] ()
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] ()
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00132s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00125s] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007375s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009163s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009917s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01173s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01391s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01741s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01929s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01996s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01786s ago] (8,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02367s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0255s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02723s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02788s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02961s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03133s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03193s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02975s ago] (9,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03548s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03719s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03781s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03959s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04132s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04196s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03974s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04545s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0471s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04779s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04953s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05126s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05192s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05373s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05548s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05714s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05904s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05975s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0615s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05924s ago] (11,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06391s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06571s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06743s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06908s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06981s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07154s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07325s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07388s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07174s ago] (12,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07778s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07975s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08165s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08369s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08173s ago] (13,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08778s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08973s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09155s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09335s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09399s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09579s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09361s ago] (14,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09934s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09998s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1019s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1037s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1056s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1075s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1092s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.106s ago] (15,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1116s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1143s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1161s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1168s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1186s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1204s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1225s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1194s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1255s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1273s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1279s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1297s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1315s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1331s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1338s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1356s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1373s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1341s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1398s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1416s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1434s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1451s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1458s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1476s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1493s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.146s ago] (18,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1518s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1536s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1554s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1571s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1578s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1595s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1613s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1619s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1636s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1614s ago] (19,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1671s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1679s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1696s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1714s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.173s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1738s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1755s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1732s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1779s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1813s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.182s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1838s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1855s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1882s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1889s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1869s ago] (21,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1928s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1947s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1964s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1931s ago] (22,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1988s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2006s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2023s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.203s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2047s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2065s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2082s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2049s ago] (23,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2108s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2127s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2146s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2164s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[cached since 0.2211s ago] ()
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date BETWEEN ? AND ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('2025-02-19', '2025-03-21')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.003621s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.005646s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007716s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008506s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01047s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01247s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[generated in 0.00034s] (1, 'scheduled', 'confirmed')
INFO:routes:Обработка подтверждения для записи 29
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("master_service_association")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("clients")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("appointments")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("services")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("masters")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("specializations")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schedules")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("users")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002275s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.004135s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006046s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006796s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008674s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01076s ago] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01258s ago] ('Мужская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01437s ago] ('Женская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01621s ago] ('Окрашивание волос', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01808s ago] ('Бритье', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01995s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02078s ago] ('Чистка лица', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02275s ago] ('Пилинг', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02468s ago] ('Наращивание ресниц', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0266s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02848s ago] ('Маникюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0303s ago] ('Педикюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03208s ago] ('Дизайн ногтей', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03278s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03458s ago] ('SPA-массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03622s ago] ('Антицеллюлитный массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03804s ago] ('Ароматерапия', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03994s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04188s ago] ('Восковая эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04273s ago] ('Лазерная эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04458s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04644s ago] ('Вечерний макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04834s ago] ('Свадебный макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('Иван Петров', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('Мужская стрижка', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002249s ago] ('Бритье', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008035s ago] ('Ольга Сидорова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006078s ago] ('Женская стрижка', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007853s ago] ('Окрашивание волос', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01251s ago] ('Анна Иванова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01044s ago] ('Маникюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01222s ago] ('Педикюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01398s ago] ('Дизайн ногтей', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01469s ago] ('Вечерний макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01644s ago] ('Свадебный макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02207s ago] ('Мария Кузнецова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02005s ago] ('Наращивание ресниц', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02179s ago] ('Коррекция бровей', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02641s ago] ('Александр Смирнов', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02429s ago] ('SPA-массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02603s ago] ('Антицеллюлитный массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03058s ago] ('Ирина Смирнова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02849s ago] ('Мужская стрижка', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03027s ago] ('Антицеллюлитный массаж', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03207s ago] ('Чистка лица', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0366s ago] ('Елена Аксенова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03453s ago] ('Чистка лица', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0363s ago] ('Пилинг', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03806s ago] ('Ароматерапия', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03985s ago] ('Восковая эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04064s ago] ('Лазерная эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ()
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ()
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00133s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007105s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007946s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009804s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01161s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01341s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01513s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01588s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01766s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01557s ago] (8,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02124s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02202s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02386s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02561s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02746s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02935s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0311s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02806s ago] (9,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03391s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03575s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03755s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03937s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04112s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04193s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03989s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04538s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0481s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04896s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05076s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05261s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05438s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05612s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05685s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05859s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06075s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06258s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06434s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06119s ago] (11,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06681s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06862s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07039s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07208s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07284s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07463s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07647s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07835s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07637s ago] (12,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08211s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08296s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08481s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08672s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08472s ago] (13,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0904s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09214s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09288s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09472s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09649s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0982s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09506s ago] (14,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1007s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1025s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1042s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1049s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1067s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1084s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1101s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1071s ago] (15,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1127s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1145s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1161s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1169s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1186s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1203s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.121s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.119s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1249s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1267s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1284s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1301s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1308s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1325s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1342s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1349s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1379s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1369s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1414s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.142s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1438s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1456s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1473s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1479s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1497s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1476s ago] (18,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1533s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1551s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1559s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1577s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1594s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1611s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1619s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1637s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1654s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1633s ago] (19,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1691s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1699s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1717s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1735s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1753s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1781s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1801s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1771s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1828s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1846s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1863s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.187s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1888s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1905s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1922s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1891s ago] (21,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1949s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1967s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1985s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1964s ago] (22,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2009s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2028s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2046s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2065s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2084s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2101s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2109s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2088s ago] (23,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2144s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2162s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2169s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2186s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[cached since 0.2233s ago] ()
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date BETWEEN ? AND ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('2025-02-19', '2025-03-21')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.001832s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.002614s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006899s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.00885s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01087s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01283s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[generated in 0.00341s] (1, 'scheduled', 'confirmed')
INFO:routes:Обработка подтверждения для записи 29
INFO:routes:Задача 643df1f0-1631-455d-94ab-f90f18daf734 отменена.
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE appointments SET version_id=?, confirmation_status=? WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00343s] (10, 'confirmed', 29, 9)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00334s] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, next_week_start=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00026s] ('active', 0, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00330s] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
/root/my_flask_bot/venv/lib/python3.12/site-packages/celery/platforms.py:829: SecurityWarning: You're running the worker with superuser privileges: this is
absolutely not recommended!

Please specify a different user using the --uid option.

User information: uid=0 euid=0 gid=0 egid=0

  warnings.warn(SecurityWarning(ROOT_DISCOURAGED.format(
[2025-02-19 04:13:40,454: DEBUG/MainProcess] | Worker: Preparing bootsteps.
[2025-02-19 04:13:40,461: DEBUG/MainProcess] | Worker: Building graph...
[2025-02-19 04:13:40,461: DEBUG/MainProcess] | Worker: New boot order: {StateDB, Timer, Hub, Pool, Autoscaler, Beat, Consumer}
[2025-02-19 04:13:40,479: DEBUG/MainProcess] | Consumer: Preparing bootsteps.
[2025-02-19 04:13:40,479: DEBUG/MainProcess] | Consumer: Building graph...
[2025-02-19 04:13:40,507: DEBUG/MainProcess] | Consumer: New boot order: {Connection, Events, Heart, Mingle, Tasks, Control, Agent, Gossip, event loop}
CELERY_BROKER_URL: redis://:1985@89.111.154.32:6379/0
 
 -------------- celery@cv4398397.novalocal v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-6.8.0-51-generic-x86_64-with-glibc2.39 2025-02-19 04:13:40
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         app:0x70f1bb249b20
- ** ---------- .> transport:   redis://:**@89.111.154.32:6379/0
- ** ---------- .> results:     redis://:**@89.111.154.32:6379/0
- *** --- * --- .> concurrency: 1 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . celery.accumulate
  . celery.backend_cleanup
  . celery.chain
  . celery.chord
  . celery.chord_unlock
  . celery.chunks
  . celery.group
  . celery.map
  . celery.starmap
  . tasks.check_confirmation
  . tasks.cleanup_old_appointments
  . tasks.send_1h_reminder
  . tasks.send_24h_reminder

[2025-02-19 04:13:40,541: DEBUG/MainProcess] | Worker: Starting Hub
[2025-02-19 04:13:40,543: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:40,543: DEBUG/MainProcess] | Worker: Starting Pool
[2025-02-19 04:13:40,718: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:40,722: DEBUG/MainProcess] | Worker: Starting Consumer
[2025-02-19 04:13:40,722: DEBUG/MainProcess] | Consumer: Starting Connection
[2025-02-19 04:13:40,771: INFO/MainProcess] Connected to redis://:**@89.111.154.32:6379/0
[2025-02-19 04:13:40,771: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:40,771: DEBUG/MainProcess] | Consumer: Starting Events
[2025-02-19 04:13:40,778: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:40,778: DEBUG/MainProcess] | Consumer: Starting Heart
[2025-02-19 04:13:40,785: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:40,786: DEBUG/MainProcess] | Consumer: Starting Mingle
[2025-02-19 04:13:40,786: INFO/MainProcess] mingle: searching for neighbors
[2025-02-19 04:13:41,827: WARNING/MainProcess] /root/my_flask_bot/venv/lib/python3.12/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@cv4398397.novalocal.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-02-19 04:13:41,829: INFO/MainProcess] mingle: all alone
[2025-02-19 04:13:41,829: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:41,829: DEBUG/MainProcess] | Consumer: Starting Tasks
[2025-02-19 04:13:41,842: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:41,843: DEBUG/MainProcess] | Consumer: Starting Control
[2025-02-19 04:13:41,854: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:41,854: DEBUG/MainProcess] | Consumer: Starting Gossip
[2025-02-19 04:13:41,863: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:13:41,863: DEBUG/MainProcess] | Consumer: Starting event loop
[2025-02-19 04:13:41,863: DEBUG/MainProcess] | Worker: Hub.register Pool...
[2025-02-19 04:13:41,864: INFO/MainProcess] celery@cv4398397.novalocal ready.
[2025-02-19 04:13:41,865: DEBUG/MainProcess] basic.qos: prefetch_count->4
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 32.6s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[generated in 0.00107s] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00034s] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 350.9s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00238s] ('active', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 349.2s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 384s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00026s] ()
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 351.4s ago] ('choosing_service_category', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 389.4s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 5.369s ago] ()
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_category=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] ('choosing_sub_service', 4, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00164s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00343s] (4,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 396.3s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 6.943s ago] (4,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00077s] ('choosing_master', 17, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 6.961s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 398.9s ago] (17,)
INFO:routes:Доступные мастера для услуги SPA-массаж: ['Александр Смирнов']
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 407.9s ago] ('79241908281@c.us', 1, 0)
INFO:routes:Ввод пользователя (выбор мастера): '1'
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00227s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT services.id, services.name, services.category, services.parent_service_id, services.description, services.price, services.duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 411.5s ago] (17,)
INFO:routes:Доступные мастера: ['Александр Смирнов']
INFO:routes:Выбран мастер: Александр Смирнов (ID: 5)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_master_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ('choosing_date', 5, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 406.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ('2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.004557s ago] ('2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006437s ago] ('2025-02-21', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008114s ago] ('2025-02-22', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.009579s ago] ('2025-02-23', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01156s ago] ('2025-02-24', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01348s ago] ('2025-02-25', 1, 0)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 415.4s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] ('choosing_time', '2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 413.7s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 7.465s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.master_id = ? AND schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] (5, '2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00123s] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 413.7s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 433.2s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 25.27s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 17.8s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 17.8s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00128s] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00131s] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002163s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.00397s ago] (11,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[generated in 0.00134s] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 82.53s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 455.3s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 454.6s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.02605s] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05585s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05921s ago] (11,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 423s ago] ('waiting_for_cancellation', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 461s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 460.2s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:DELETE FROM appointments WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00131s] (26, 3)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 71.58s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] (1, '2025-02-19')
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 460.3s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 71.68s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[cached since 428.5s ago] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 428.4s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 467.2s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00130s] ('active', None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 465.5s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 474.9s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 90.91s ago] ()
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 442.3s ago] ('choosing_service_category', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 480s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00124s] ()
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 129.1s ago] ('choosing_sub_service', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 478.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00132s] (4,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 485.8s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 96.37s ago] (4,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 89.43s ago] ('choosing_master', 17, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 96.39s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 89.42s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 488.4s ago] (17,)
INFO:routes:Доступные мастера для услуги SPA-массаж: ['Александр Смирнов']
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 489.3s ago] ('79241908281@c.us', 1, 0)
INFO:routes:Ввод пользователя (выбор мастера): '1'
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 81.37s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT services.id, services.name, services.category, services.parent_service_id, services.description, services.price, services.duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 81.37s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 492.8s ago] (17,)
INFO:routes:Доступные мастера: ['Александр Смирнов']
INFO:routes:Выбран мастер: Александр Смирнов (ID: 5)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 138.4s ago] ('choosing_date', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 487.6s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.32s ago] ('2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.32s ago] ('2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.32s ago] ('2025-02-21', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.32s ago] ('2025-02-22', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.33s ago] ('2025-02-23', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.33s ago] ('2025-02-24', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 81.33s ago] ('2025-02-25', 1, 0)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 494.1s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 78.7s ago] ('choosing_time', '2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 492.4s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 86.17s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.master_id = ? AND schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 78.7s ago] (5, '2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 78.7s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 78.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 492.4s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 504.8s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00130s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00122s] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 49.44s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 49.44s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 49.45s ago] (11,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[cached since 472.3s ago] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 472.3s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 555.2s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 554.5s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 99.84s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 99.84s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 99.84s ago] (11,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 522.6s ago] ('waiting_for_cancellation', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 562s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 561.3s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:DELETE FROM appointments WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 101s ago] (30, 13)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 172.6s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= ?
INFO:sqlalchemy.engine.Engine:[cached since 101s ago] (1, '2025-02-19')
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 561.4s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 172.7s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[cached since 529.5s ago] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 529.5s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 571.9s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00035s] ('active', None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 182.5s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 577.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 97.71s ago] ()
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 226.9s ago] ('choosing_service_category', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 585s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 105s ago] ()
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 234.1s ago] ('choosing_sub_service', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 583.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 105s ago] (4,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 591.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 202.3s ago] (4,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 195.3s ago] ('choosing_master', 17, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 202.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 195.3s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 594.3s ago] (17,)
INFO:routes:Доступные мастера для услуги SPA-массаж: ['Александр Смирнов']
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 596.4s ago] ('79241908281@c.us', 1, 0)
INFO:routes:Ввод пользователя (выбор мастера): '1'
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT services.id, services.name, services.category, services.parent_service_id, services.description, services.price, services.duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 599.9s ago] (17,)
INFO:routes:Доступные мастера: ['Александр Смирнов']
INFO:routes:Выбран мастер: Александр Смирнов (ID: 5)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 245.5s ago] ('choosing_date', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 594.7s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-21', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-22', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-23', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-24', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 188.4s ago] ('2025-02-25', 1, 0)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 607.2s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 191.8s ago] ('choosing_time', '2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 605.5s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 199.3s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.master_id = ? AND schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 191.8s ago] (5, '2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 191.8s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 191.8s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 605.5s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 615.5s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 207.6s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 200.1s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 200.1s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 182.3s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 182.3s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 182.3s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 182.3s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 200.1s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 676.5s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 221.1s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 221.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 171.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 735.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 327.8s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 320.3s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 320.3s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 302.5s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 302.5s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 302.5s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 302.5s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 320.3s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 796.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 341.3s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 341.3s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 291.9s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 855.9s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 447.9s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 440.5s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 440.5s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 422.7s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 422.7s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 422.7s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 422.7s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 440.5s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 915.9s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 508s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 500.5s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 500.5s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 482.7s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 482.7s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 482.7s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 482.7s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 500.6s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 976.3s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 568.4s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 561.4s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 561.5s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 543.8s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 543.8s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 543.9s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 544s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 561.8s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1038s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 583.1s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 583.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 533.6s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1098s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 643.1s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 643.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 593.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1159s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 703.2s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 703.2s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 653.8s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1218s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 810.4s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 803s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 803.1s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 785.3s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 785.3s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 785.3s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 785.3s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 803.1s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1279s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 824.1s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 824.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 774.7s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1339s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 930.7s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 923.3s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 923.3s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 905.5s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 905.5s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 905.5s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 905.5s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 923.3s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1399s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 990.8s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 983.4s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 983.4s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 965.6s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 965.6s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 965.6s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 965.6s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 983.4s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1460s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 954.9s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 954.9s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 954.9s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 954.9s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 954.9s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1004s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1004s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 955s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1520s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1064s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1064s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1015s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1579s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1171s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1164s ago] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1164s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1146s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 1146s ago] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1146s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1146s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1164s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:ROLLBACK
ERROR:app:Exception on /webhook/ [POST]
Traceback (most recent call last):
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/routes.py", line 47, in webhook
    handle_client_message(chat_id, message)
  File "/root/my_flask_bot/routes.py", line 339, in handle_client_message
    process_client_input(client, message.strip())
  File "/root/my_flask_bot/routes.py", line 359, in process_client_input
    handler(client, message)
  File "/root/my_flask_bot/routes.py", line 280, in process_time_selection
    create_appointment(client, selected_time)
  File "/root/my_flask_bot/routes.py", line 458, in create_appointment
    db.session.commit()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 599, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1002, in _emit_insert_statements
    for (
  File "/root/my_flask_bot/venv/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 402, in _collect_insert_commands
    params[mapper.version_id_col.key] = mapper.version_id_generator(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/my_flask_bot/models.py", line 71, in <lambda>
    "version_id_generator": lambda v: v +1
                                      ~~^~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'int'
[2025-02-19 04:40:42 +0300] [163147] [INFO] Worker exiting (pid: 163147)
[2025-02-19 04:40:42 +0300] [163146] [INFO] Worker exiting (pid: 163146)
CELERY_BROKER_URL: redis://:1985@89.111.154.32:6379/0
CELERY_BROKER_URL: redis://:1985@89.111.154.32:6379/0
[2025-02-19 04:40:42 +0300] [163145] [INFO] Handling signal: term
[2025-02-19 04:40:43 +0300] [163145] [INFO] Shutting down: Master

worker: Warm shutdown (MainProcess)
[2025-02-19 04:40:50,430: DEBUG/MainProcess] | Worker: Closing Hub...
[2025-02-19 04:40:50,434: DEBUG/MainProcess] | Worker: Closing Pool...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Worker: Closing Consumer...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Worker: Stopping Consumer...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Consumer: Closing Connection...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Consumer: Closing Events...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Consumer: Closing Heart...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Consumer: Closing Mingle...
[2025-02-19 04:40:50,435: DEBUG/MainProcess] | Consumer: Closing Tasks...
[2025-02-19 04:40:50,437: DEBUG/MainProcess] | Consumer: Closing Control...
[2025-02-19 04:40:50,438: DEBUG/MainProcess] | Consumer: Closing Gossip...
[2025-02-19 04:40:50,438: DEBUG/MainProcess] | Consumer: Closing event loop...
[2025-02-19 04:40:50,438: DEBUG/MainProcess] | Consumer: Stopping event loop...
[2025-02-19 04:40:50,438: DEBUG/MainProcess] | Consumer: Stopping Gossip...
[2025-02-19 04:40:50,447: DEBUG/MainProcess] | Consumer: Stopping Control...
[2025-02-19 04:40:50,453: DEBUG/MainProcess] | Consumer: Stopping Tasks...
[2025-02-19 04:40:50,453: DEBUG/MainProcess] Canceling task consumer...
[2025-02-19 04:40:50,453: DEBUG/MainProcess] | Consumer: Stopping Mingle...
[2025-02-19 04:40:50,453: DEBUG/MainProcess] | Consumer: Stopping Heart...
[2025-02-19 04:40:50,454: DEBUG/MainProcess] | Consumer: Stopping Events...
[2025-02-19 04:40:50,454: DEBUG/MainProcess] | Consumer: Stopping Connection...
[2025-02-19 04:40:50,454: DEBUG/MainProcess] | Worker: Stopping Pool...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Worker: Stopping Hub...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Consumer: Shutdown Gossip...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Consumer: Shutdown Control...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Consumer: Shutdown Tasks...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] Canceling task consumer...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] Closing consumer channel...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Consumer: Shutdown Heart...
[2025-02-19 04:40:50,455: DEBUG/MainProcess] | Consumer: Shutdown Events...
[2025-02-19 04:40:50,456: DEBUG/MainProcess] | Consumer: Shutdown Connection...
[2025-02-19 04:40:50,754: DEBUG/MainProcess] removing tasks from inqueue until task handler finished
[2025-02-19 04:41:00 +0300] [165302] [INFO] Starting gunicorn 23.0.0
[2025-02-19 04:41:00 +0300] [165302] [INFO] Listening at: http://0.0.0.0:5000 (165302)
[2025-02-19 04:41:00 +0300] [165302] [INFO] Using worker: sync
[2025-02-19 04:41:00 +0300] [165303] [INFO] Booting worker with pid: 165303
[2025-02-19 04:41:00 +0300] [165304] [INFO] Booting worker with pid: 165304
/root/my_flask_bot/venv/lib/python3.12/site-packages/celery/platforms.py:829: SecurityWarning: You're running the worker with superuser privileges: this is
absolutely not recommended!

Please specify a different user using the --uid option.

User information: uid=0 euid=0 gid=0 egid=0

  warnings.warn(SecurityWarning(ROOT_DISCOURAGED.format(
[2025-02-19 04:41:17,235: DEBUG/MainProcess] | Worker: Preparing bootsteps.
[2025-02-19 04:41:17,241: DEBUG/MainProcess] | Worker: Building graph...
[2025-02-19 04:41:17,241: DEBUG/MainProcess] | Worker: New boot order: {Timer, Hub, Pool, Autoscaler, Beat, StateDB, Consumer}
[2025-02-19 04:41:17,255: DEBUG/MainProcess] | Consumer: Preparing bootsteps.
[2025-02-19 04:41:17,255: DEBUG/MainProcess] | Consumer: Building graph...
[2025-02-19 04:41:17,282: DEBUG/MainProcess] | Consumer: New boot order: {Connection, Agent, Events, Heart, Mingle, Tasks, Control, Gossip, event loop}
CELERY_BROKER_URL: redis://:1985@89.111.154.32:6379/0
 
 -------------- worker1@cv4398397.novalocal v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-6.8.0-51-generic-x86_64-with-glibc2.39 2025-02-19 04:41:17
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         app:0x70d112745a60
- ** ---------- .> transport:   redis://:**@89.111.154.32:6379/0
- ** ---------- .> results:     redis://:**@89.111.154.32:6379/0
- *** --- * --- .> concurrency: 1 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . celery.accumulate
  . celery.backend_cleanup
  . celery.chain
  . celery.chord
  . celery.chord_unlock
  . celery.chunks
  . celery.group
  . celery.map
  . celery.starmap
  . tasks.check_confirmation
  . tasks.cleanup_old_appointments
  . tasks.send_1h_reminder
  . tasks.send_24h_reminder

[2025-02-19 04:41:17,305: DEBUG/MainProcess] | Worker: Starting Hub
[2025-02-19 04:41:17,305: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:17,305: DEBUG/MainProcess] | Worker: Starting Pool
[2025-02-19 04:41:17,442: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:17,446: DEBUG/MainProcess] | Worker: Starting Consumer
[2025-02-19 04:41:17,446: DEBUG/MainProcess] | Consumer: Starting Connection
[2025-02-19 04:41:17,498: INFO/MainProcess] Connected to redis://:**@89.111.154.32:6379/0
[2025-02-19 04:41:17,498: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:17,498: DEBUG/MainProcess] | Consumer: Starting Events
[2025-02-19 04:41:17,503: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:17,503: DEBUG/MainProcess] | Consumer: Starting Heart
[2025-02-19 04:41:17,509: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:17,509: DEBUG/MainProcess] | Consumer: Starting Mingle
[2025-02-19 04:41:17,509: INFO/MainProcess] mingle: searching for neighbors
[2025-02-19 04:41:18,559: WARNING/MainProcess] /root/my_flask_bot/venv/lib/python3.12/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@cv4398397.novalocal.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-02-19 04:41:18,559: INFO/MainProcess] mingle: sync with 1 nodes
[2025-02-19 04:41:18,560: DEBUG/MainProcess] mingle: processing reply from celery@cv4398397.novalocal
[2025-02-19 04:41:18,560: INFO/MainProcess] mingle: sync complete
[2025-02-19 04:41:18,560: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:18,560: DEBUG/MainProcess] | Consumer: Starting Tasks
[2025-02-19 04:41:18,569: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:18,569: DEBUG/MainProcess] | Consumer: Starting Control
[2025-02-19 04:41:18,578: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:18,578: DEBUG/MainProcess] | Consumer: Starting Gossip
[2025-02-19 04:41:18,586: DEBUG/MainProcess] ^-- substep ok
[2025-02-19 04:41:18,587: DEBUG/MainProcess] | Consumer: Starting event loop
[2025-02-19 04:41:18,587: DEBUG/MainProcess] | Worker: Hub.register Pool...
[2025-02-19 04:41:18,588: INFO/MainProcess] worker1@cv4398397.novalocal ready.
[2025-02-19 04:41:18,588: DEBUG/MainProcess] basic.qos: prefetch_count->4
[2025-02-19 04:41:20,373: DEBUG/MainProcess] celery@cv4398397.novalocal joined the party
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00135s] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] ('2025-02-20', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00123s] (5,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00121s] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.001967s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02352s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:INSERT INTO appointments (version_id, client_id, service_id, master_id, date, time, status, confirmation_status, reminder_task_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] (1, 1, 17, 5, '2025-02-20', '12:30:00.000000', 'scheduled', 'pending', None)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04396s ago] ('2025-02-20', 5)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00015s] (17,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00117s] (5,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("master_service_association")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("clients")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("appointments")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("services")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("masters")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("specializations")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schedules")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("users")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.002523s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.004417s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006286s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008856s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.011s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01336s ago] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01534s ago] ('Мужская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01722s ago] ('Женская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01922s ago] ('Окрашивание волос', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0211s ago] ('Бритье', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02308s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02493s ago] ('Чистка лица', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02668s ago] ('Пилинг', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02742s ago] ('Наращивание ресниц', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02914s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03088s ago] ('Маникюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03268s ago] ('Педикюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03341s ago] ('Дизайн ногтей', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03521s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0372s ago] ('SPA-массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03901s ago] ('Антицеллюлитный массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04085s ago] ('Ароматерапия', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04151s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04326s ago] ('Восковая эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04499s ago] ('Лазерная эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04669s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04736s ago] ('Вечерний макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04907s ago] ('Свадебный макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('Иван Петров', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('Мужская стрижка', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.003537s ago] ('Бритье', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.008005s ago] ('Ольга Сидорова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006092s ago] ('Женская стрижка', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007857s ago] ('Окрашивание волос', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01224s ago] ('Анна Иванова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01129s ago] ('Маникюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01202s ago] ('Педикюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01384s ago] ('Дизайн ногтей', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01574s ago] ('Вечерний макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01758s ago] ('Свадебный макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.022s ago] ('Мария Кузнецова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02008s ago] ('Наращивание ресниц', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02191s ago] ('Коррекция бровей', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02631s ago] ('Александр Смирнов', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02541s ago] ('SPA-массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02615s ago] ('Антицеллюлитный массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03054s ago] ('Ирина Смирнова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02962s ago] ('Мужская стрижка', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03129s ago] ('Антицеллюлитный массаж', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03201s ago] ('Чистка лица', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03635s ago] ('Елена Аксенова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03542s ago] ('Чистка лица', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0361s ago] ('Пилинг', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03781s ago] ('Ароматерапия', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03954s ago] ('Восковая эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04018s ago] ('Лазерная эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services
INFO:sqlalchemy.engine.Engine:[generated in 0.00014s] ()
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] ()
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00037s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008094s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01037s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0125s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01465s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01855s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02217s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02328s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02532s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02311s ago] (8,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02953s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03287s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0351s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03727s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03926s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04129s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04336s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0412s ago] (9,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04875s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0508s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05288s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05528s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05765s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06116s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05888s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06498s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06681s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06758s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06933s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07128s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07428s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07619s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07804s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0798s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08054s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08227s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08398s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08773s ago] (11,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0938s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09454s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09623s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09797s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09862s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1004s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1021s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.104s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1019s ago] (12,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1082s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1104s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1123s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1142s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1117s ago] (13,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1177s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1198s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1218s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1227s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1246s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1265s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1241s ago] (14,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1303s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1321s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.134s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1358s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1365s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1382s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.14s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1364s ago] (15,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1425s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1443s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.146s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1466s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1483s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.15s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1506s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1481s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1541s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1558s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1565s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1582s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1599s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1606s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1623s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.164s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1647s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1622s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1682s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1699s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1717s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1726s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1744s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1762s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1779s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1743s ago] (18,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1803s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.182s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1837s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1844s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1861s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1877s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1884s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.19s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1917s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1881s ago] (19,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1941s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1958s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1982s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1989s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1995s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2011s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2027s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1991s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2051s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2067s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2074s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2091s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2107s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2115s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2131s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2105s ago] (21,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2154s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2171s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2187s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2153s ago] (22,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2213s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.223s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2236s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2253s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.227s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2276s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2292s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2266s ago] (23,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2315s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2332s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2348s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2354s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[cached since 0.2413s ago] ()
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date BETWEEN ? AND ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('2025-02-19', '2025-03-21')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.002373s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.004249s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006176s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.008252s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01004s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01184s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:routes:Запланированы напоминания для записи 30:
INFO:routes:  Напоминание за 24 часа: 2025-02-19T01:30:00+00:00
INFO:routes:  Напоминание за 1 час: 2025-02-20T00:30:00+00:00
WARNING:routes:Время для 24h напоминания прошло.
INFO:routes:1h reminder scheduled.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00337s] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, next_week_start=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00019s] ('active', 0, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1.201s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 18.69s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[generated in 0.00032s] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00038s] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[generated in 0.00031s] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00127s] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.003454s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 0.005208s ago] (17,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ('waiting_for_cancellation', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 29.88s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[generated in 0.00034s] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:DELETE FROM appointments WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] (30, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 29.8s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] (1, '2025-02-19')
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 0.1213s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 29.92s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[cached since 11.31s ago] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 11.28s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 12.36s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 12.24s ago] ('active', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 40.92s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00018s] ()
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 22.21s ago] ('choosing_service_category', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 44.81s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 3.886s ago] ()
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_category=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] ('choosing_sub_service', 1, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 44.72s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00017s] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 26.65s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00124s] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00021s] ('choosing_master', 10, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 14.29s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00028s] (10,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 106.8s ago] (10,)
INFO:routes:Доступные мастера для услуги Бритье: ['Иван Петров']
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 55.79s ago] ('79241908281@c.us', 1, 0)
INFO:routes:Ввод пользователя (выбор мастера): '1'
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 55.74s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT services.id, services.name, services.category, services.parent_service_id, services.description, services.price, services.duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] (10,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 111.5s ago] (10,)
INFO:routes:Доступные мастера: ['Иван Петров']
INFO:routes:Выбран мастер: Иван Петров (ID: 1)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_master_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00132s] ('choosing_date', 1, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 55.71s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00127s] ('2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.003498s ago] ('2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.005361s ago] ('2025-02-21', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007089s ago] ('2025-02-22', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007796s ago] ('2025-02-23', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.009488s ago] ('2025-02-24', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01117s ago] ('2025-02-25', 1, 0)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 37.85s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.08841s] ('choosing_time', '2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 26.37s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00934s] (10,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.master_id = ? AND schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00488s] (1, '2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.01321s] ('2025-02-20', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00616s] ('2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 26.82s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 51.22s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 12.38s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 12.35s ago] ('2025-02-20', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 12.28s ago] ('2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00447s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00924s] (1, '2025-02-20')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 51.57s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 51.65s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 12.66s ago] ('2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:INSERT INTO appointments (version_id, client_id, service_id, master_id, date, time, status, confirmation_status, reminder_task_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[generated in 0.02175s] (1, 1, 10, 1, '2025-02-20', '12:45:00.000000', 'scheduled', 'pending', None)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 39.73s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 13.18s ago] ('2025-02-20', 1)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 25.68s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.02408s] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("master_service_association")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("clients")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("appointments")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("services")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("masters")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("specializations")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("schedules")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:PRAGMA main.table_info("users")
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01266s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01389s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01639s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01704s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02008s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0235s ago] ('Парикмахерские услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02436s ago] ('Мужская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02725s ago] ('Женская стрижка', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02903s ago] ('Окрашивание волос', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03156s ago] ('Бритье', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03495s ago] ('Косметические услуги', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03748s ago] ('Чистка лица', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04179s ago] ('Пилинг', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04691s ago] ('Наращивание ресниц', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.04884s ago] ('Ногтевой сервис', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05063s ago] ('Маникюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0513s ago] ('Педикюр', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05301s ago] ('Дизайн ногтей', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05463s ago] ('Массаж и SPA', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05697s ago] ('SPA-массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05758s ago] ('Антицеллюлитный массаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0581s ago] ('Ароматерапия', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.05969s ago] ('Эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.06027s ago] ('Восковая эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.06204s ago] ('Лазерная эпиляция', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.06327s ago] ('Визаж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.06501s ago] ('Вечерний макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.06621s ago] ('Свадебный макияж', 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] ('Иван Петров', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00111s] ('Мужская стрижка', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.00233s ago] ('Бритье', 1, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.006973s ago] ('Ольга Сидорова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.005407s ago] ('Женская стрижка', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.007362s ago] ('Окрашивание волос', 2, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01112s ago] ('Анна Иванова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.009776s ago] ('Маникюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0109s ago] ('Педикюр', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01215s ago] ('Дизайн ногтей', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01271s ago] ('Вечерний макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0153s ago] ('Свадебный макияж', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01967s ago] ('Мария Кузнецова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01857s ago] ('Наращивание ресниц', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.01921s ago] ('Коррекция бровей', 4, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.0229s ago] ('Александр Смирнов', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02233s ago] ('SPA-массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02295s ago] ('Антицеллюлитный массаж', 5, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02741s ago] ('Ирина Смирнова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02478s ago] ('Мужская стрижка', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02749s ago] ('Антицеллюлитный массаж', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.02825s ago] ('Чистка лица', 6, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.name = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.032s ago] ('Елена Аксенова', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03095s ago] ('Чистка лица', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03224s ago] ('Пилинг', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03342s ago] ('Ароматерапия', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03523s ago] ('Восковая эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE specializations.name = ? AND specializations.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 0.03593s ago] ('Лазерная эпиляция', 7, 1, 0)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services
INFO:sqlalchemy.engine.Engine:[generated in 0.00013s] ()
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[generated in 0.00020s] ()
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00023s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00125s] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.006121s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007804s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009635s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01032s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01256s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01505s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01574s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01629s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01591s ago] (8,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02062s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02122s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02397s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02509s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02571s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.02626s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0293s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0276s ago] (9,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03203s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03369s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03489s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03668s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03734s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03906s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.03758s ago] (10,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04276s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04449s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0452s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04727s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.04792s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05065s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05219s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05299s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05517s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05587s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05765s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05963s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.05764s ago] (11,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06307s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06431s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06492s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06591s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06899s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.06969s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07024s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.073s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07139s ago] (12,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07644s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07705s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.0787s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07929s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.07747s ago] (13,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08263s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08322s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08494s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08685s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08853s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08915s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.08751s ago] (14,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09267s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09334s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09511s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09699s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.09942s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1001s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1015s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1006s ago] (15,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1047s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1053s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1071s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1093s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.11s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1128s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1147s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1131s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1172s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1193s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.12s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.122s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1238s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1255s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1261s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1279s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.129s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1274s ago] (17,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1314s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1331s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1367s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1375s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.138s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1393s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1399s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1389s ago] (18,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.143s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1457s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1463s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.149s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1496s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1527s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1542s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1565s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1595s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1591s ago] (19,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1634s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.164s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1661s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1694s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1701s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.172s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1746s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1719s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1775s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1781s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1797s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1803s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1826s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1839s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1845s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1817s ago] (21,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1879s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1893s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1903s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1887s ago] (22,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1936s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1949s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1959s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1973s ago] (7,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1986s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1992s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2006s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.1987s ago] (23,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2027s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2033s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2063s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT specializations.id AS specializations_id, specializations.name AS specializations_name, specializations.master_id AS specializations_master_id 
FROM specializations 
WHERE ? = specializations.master_id
INFO:sqlalchemy.engine.Engine:[cached since 0.2079s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters
INFO:sqlalchemy.engine.Engine:[cached since 0.2127s ago] ()
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date BETWEEN ? AND ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00177s] ('2025-02-19', '2025-03-21')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.002718s ago] (2,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.005569s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.007741s ago] (4,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.009742s ago] (5,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01202s ago] (6,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services, master_service_association 
WHERE ? = master_service_association.master_id AND services.id = master_service_association.service_id
INFO:sqlalchemy.engine.Engine:[cached since 0.01399s ago] (7,)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:routes:Запланированы напоминания для записи 30:
INFO:routes:  Напоминание за 24 часа: 2025-02-19T01:45:00+00:00
INFO:routes:  Напоминание за 1 час: 2025-02-20T00:45:00+00:00
INFO:routes:24h reminder scheduled.
INFO:routes:1h reminder scheduled.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00155s] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, next_week_start=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00311s] ('active', 0, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 42.08s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
[2025-02-19 04:45:00,156: INFO/MainProcess] Task tasks.send_1h_reminder[4ed29ef7-bb2e-4686-afc1-5a4d7d98cd77] received
[2025-02-19 04:45:00,160: DEBUG/MainProcess] basic.qos: prefetch_count->5
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 200.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 170.9s ago] (1, 'scheduled', 'confirmed')
INFO:routes:Обработка подтверждения для записи 30
INFO:routes:Задача 4ed29ef7-bb2e-4686-afc1-5a4d7d98cd77 отменена.
[2025-02-19 04:45:19,754: DEBUG/MainProcess] pidbox received method revoke(task_id='4ed29ef7-bb2e-4686-afc1-5a4d7d98cd77', terminate=True, signal='SIGTERM') [reply_to:None ticket:None]
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE appointments SET version_id=?, confirmation_status=? WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (3, 'confirmed', 30, 2)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 199.6s ago] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, next_week_start=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 199.6s ago] ('active', 0, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 200.8s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 304.5s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[cached since 285.8s ago] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 285.8s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 404.2s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 385.4s ago] ('active', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 404.1s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 386.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] ()
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 386.7s ago] ('choosing_service_category', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 418.5s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id IS NULL
INFO:sqlalchemy.engine.Engine:[cached since 377.6s ago] ()
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_category=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.7s ago] ('choosing_sub_service', 3, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 418.5s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.7s ago] (3,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 399.7s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.parent_service_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.1s ago] (3,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_service_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.1s ago] ('choosing_master', 16, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 387.4s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 479.9s ago] (16,)
INFO:routes:Доступные мастера для услуги Дизайн ногтей: ['Анна Иванова']
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 430.5s ago] ('79241908281@c.us', 1, 0)
INFO:routes:Ввод пользователя (выбор мастера): '1'
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 430.5s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id, services.name, services.category, services.parent_service_id, services.description, services.price, services.duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 374.7s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters, master_service_association 
WHERE ? = master_service_association.service_id AND masters.id = master_service_association.master_id
INFO:sqlalchemy.engine.Engine:[cached since 486.3s ago] (16,)
INFO:routes:Доступные мастера: ['Анна Иванова']
INFO:routes:Выбран мастер: Анна Иванова (ID: 3)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_master_id=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 374.7s ago] ('choosing_date', 3, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 430.5s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.7s ago] ('2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-20', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-21', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-22', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-23', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-24', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 374.8s ago] ('2025-02-25', 1, 0)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 412s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 374s ago] ('choosing_time', '2025-02-19', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 399.6s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 373.1s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.master_id = ? AND schedules.date = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 373s ago] (3, '2025-02-19', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 373s ago] ('2025-02-19', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 372.9s ago] ('2025-02-19', 3)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 399.6s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 420.6s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 381.7s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT schedules.id AS schedules_id, schedules.date AS schedules_date, schedules.appointment_time AS schedules_appointment_time, schedules.is_working_day AS schedules_is_working_day, schedules.opening_time AS schedules_opening_time, schedules.closing_time AS schedules_closing_time, schedules.master_id AS schedules_master_id, schedules.service_id AS schedules_service_id 
FROM schedules 
WHERE schedules.date = ? AND schedules.master_id = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 381.6s ago] ('2025-02-19', 3, 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 381.5s ago] ('2025-02-19', 3)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 369.1s ago] (3,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date = ?
INFO:sqlalchemy.engine.Engine:[cached since 369.1s ago] (1, '2025-02-19')
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 381.5s ago] ('2025-02-19', 3)
INFO:sqlalchemy.engine.Engine:INSERT INTO appointments (version_id, client_id, service_id, master_id, date, time, status, confirmation_status, reminder_task_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?) RETURNING id
INFO:sqlalchemy.engine.Engine:[cached since 368.7s ago] (1, 1, 16, 3, '2025-02-19', '14:00:00.000000', 'scheduled', 'pending', None)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 408.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.date = ? AND appointments.master_id = ?
INFO:sqlalchemy.engine.Engine:[cached since 381.6s ago] ('2025-02-19', 3)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 394s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT masters.id AS masters_id, masters.name AS masters_name 
FROM masters 
WHERE masters.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 368.2s ago] (3,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:routes:Запланированы напоминания для записи 31:
INFO:routes:  Напоминание за 24 часа: 2025-02-18T03:00:00+00:00
INFO:routes:  Напоминание за 1 час: 2025-02-19T02:00:00+00:00
WARNING:routes:Время для 24h напоминания прошло.
INFO:routes:1h reminder scheduled.
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 366.3s ago] (1,)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=?, next_week_start=?, selected_service_id=?, selected_date=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 366.3s ago] ('active', 0, None, None, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 408.4s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
[2025-02-19 05:01:03,881: INFO/MainProcess] Task tasks.send_1h_reminder[7c31b0f2-2785-41ba-a04c-25eee6c2c135] received
[2025-02-19 05:01:03,884: DEBUG/MainProcess] basic.qos: prefetch_count->6
[2025-02-19 05:01:03,891: INFO/MainProcess] Task tasks.send_1h_reminder[cfc3f79a-6832-44b2-b84c-30b934f4c3d0] received
[2025-02-19 05:01:03,891: DEBUG/MainProcess] basic.qos: prefetch_count->7
[2025-02-19 05:01:03,902: INFO/MainProcess] Task tasks.send_1h_reminder[038b5d4e-ae37-4cb3-b88f-7b9ba079c2a0] received
[2025-02-19 05:01:03,902: DEBUG/MainProcess] basic.qos: prefetch_count->8
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (1, 'scheduled', 'confirmed')
INFO:routes:Обработка подтверждения для записи 28
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (16,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (20,)
INFO:sqlalchemy.engine.Engine:SELECT services.id AS services_id, services.name AS services_name, services.category AS services_category, services.parent_service_id AS services_parent_service_id, services.description AS services_description, services.price AS services_price, services.duration AS services_duration 
FROM services 
WHERE services.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (10,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] ('waiting_for_cancellation', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[cached since 1148s ago] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 1148s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:DELETE FROM appointments WHERE appointments.id = ? AND appointments.version_id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] (31, 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00024s] (1, '2025-02-19')
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id 
FROM appointments 
WHERE appointments.client_id = ? AND appointments.date >= CURRENT_DATE AND appointments.status IN (?, ?) ORDER BY appointments.date ASC
INFO:sqlalchemy.engine.Engine:[cached since 1148s ago] (1, 'scheduled', 'confirmed')
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1136s ago] (1,)
INFO:sqlalchemy.engine.Engine:SELECT appointments.id AS appointments_id, appointments.version_id AS appointments_version_id, appointments.client_id AS appointments_client_id, appointments.service_id AS appointments_service_id, appointments.master_id AS appointments_master_id, appointments.date AS appointments_date, appointments.time AS appointments_time, appointments.status AS appointments_status, appointments.confirmation_status AS appointments_confirmation_status, appointments.reminder_task_id AS appointments_reminder_task_id, services_1.id AS services_1_id, services_1.name AS services_1_name, services_1.category AS services_1_category, services_1.parent_service_id AS services_1_parent_service_id, services_1.description AS services_1_description, services_1.price AS services_1_price, services_1.duration AS services_1_duration, masters_1.id AS masters_1_id, masters_1.name AS masters_1_name 
FROM appointments LEFT OUTER JOIN services AS services_1 ON services_1.id = appointments.service_id LEFT OUTER JOIN masters AS masters_1 ON masters_1.id = appointments.master_id 
WHERE appointments.client_id = ? AND appointments.date >= ? ORDER BY appointments.date, appointments.time
INFO:sqlalchemy.engine.Engine:[generated in 0.00026s] (1, '2025-02-19')
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[cached since 1148s ago] ('checking_appointments', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
[2025-02-19 05:02:43,892: INFO/MainProcess] Task tasks.send_1h_reminder[26fb7b6e-becf-4b6b-a237-a62e5f35cc86] received
[2025-02-19 05:02:43,894: DEBUG/MainProcess] basic.qos: prefetch_count->9
[2025-02-19 05:10:41,070: INFO/MainProcess] missed heartbeat from celery@cv4398397.novalocal
[2025-02-19 05:14:08 +0300] [165302] [CRITICAL] WORKER TIMEOUT (pid:165303)
[2025-02-19 05:14:12,211: WARNING/MainProcess] Substantial drift from celery@cv4398397.novalocal may mean clocks are out of sync.  Current drift is 219 seconds.  [orig: 2025-02-19 05:14:12.207669 recv: 2025-02-19 05:10:33.886484]
[2025-02-19 05:14:12,220: DEBUG/MainProcess] celery@cv4398397.novalocal joined the party
[2025-02-19 05:14:12 +0300] [165302] [ERROR] Worker (pid:165303) was sent SIGKILL! Perhaps out of memory?
[2025-02-19 05:14:12 +0300] [167646] [INFO] Booting worker with pid: 167646
[2025-02-19 05:14:22,418: INFO/MainProcess] Task tasks.send_1h_reminder[a87dd1d9-fb11-4bb2-94e4-b6bdb514aea0] received
[2025-02-19 05:14:22,422: DEBUG/MainProcess] basic.qos: prefetch_count->10
[2025-02-19 05:14:22,437: INFO/MainProcess] Task tasks.send_1h_reminder[f9c2f334-df65-419c-86c7-b9856f38acb6] received
[2025-02-19 05:14:22,437: DEBUG/MainProcess] basic.qos: prefetch_count->11
[2025-02-19 05:14:22,451: INFO/MainProcess] Task tasks.send_1h_reminder[c5bc1493-87a2-4cb8-86ba-a1261b4f9729] received
[2025-02-19 05:14:22,451: DEBUG/MainProcess] basic.qos: prefetch_count->12
[2025-02-19 05:14:22,460: INFO/MainProcess] Task tasks.send_1h_reminder[a4c9a84c-591c-4041-8a6f-7d58d6318876] received
[2025-02-19 05:14:22,460: DEBUG/MainProcess] basic.qos: prefetch_count->13
[2025-02-19 05:14:22,469: INFO/MainProcess] Task tasks.send_1h_reminder[bd119268-7329-468c-9c56-a0dbf2b1da08] received
[2025-02-19 05:14:22,469: DEBUG/MainProcess] basic.qos: prefetch_count->14
[2025-02-19 05:14:22,477: INFO/MainProcess] Task tasks.send_1h_reminder[9c29c9bf-b63b-4fba-809b-0489f07c667b] received
[2025-02-19 05:14:22,477: DEBUG/MainProcess] basic.qos: prefetch_count->15
[2025-02-19 05:14:22,487: INFO/MainProcess] Task tasks.send_1h_reminder[5a5e73b6-9335-4e02-899e-ec0c2995d58d] received
[2025-02-19 05:14:22,487: DEBUG/MainProcess] basic.qos: prefetch_count->16
[2025-02-19 05:14:22,496: INFO/MainProcess] Task tasks.send_1h_reminder[7f4dad0a-dd6c-4e0b-ab08-b636a75aa77d] received
[2025-02-19 05:14:22,496: DEBUG/MainProcess] basic.qos: prefetch_count->17
[2025-02-19 05:14:22,504: INFO/MainProcess] Task tasks.send_1h_reminder[fb8fa98a-b9a2-447e-8ee4-dc51fa8d9631] received
[2025-02-19 05:14:22,504: DEBUG/MainProcess] basic.qos: prefetch_count->18
[2025-02-19 05:14:22,511: INFO/MainProcess] Task tasks.send_1h_reminder[ee2c2177-1204-443c-83d2-6e497d9ac91a] received
[2025-02-19 05:14:22,511: DEBUG/MainProcess] basic.qos: prefetch_count->19
[2025-02-19 05:14:22,524: INFO/MainProcess] Task tasks.send_1h_reminder[602e1133-3432-4b8f-9847-073cef4bbdc4] received
[2025-02-19 05:14:22,524: DEBUG/MainProcess] basic.qos: prefetch_count->20
[2025-02-19 05:14:22,537: INFO/MainProcess] Task tasks.send_1h_reminder[b2a9ecf3-5a0e-4f87-8731-250f7d249a93] received
[2025-02-19 05:14:22,537: DEBUG/MainProcess] basic.qos: prefetch_count->21
[2025-02-19 05:14:22,545: INFO/MainProcess] Task tasks.send_1h_reminder[a5201d1a-8828-4fea-8db4-513466485ebb] received
[2025-02-19 05:14:22,545: DEBUG/MainProcess] basic.qos: prefetch_count->22
[2025-02-19 05:14:22,553: INFO/MainProcess] Task tasks.send_1h_reminder[82fd3c53-98cf-4e11-99ec-7a8f9c47a7fe] received
[2025-02-19 05:14:22,553: DEBUG/MainProcess] basic.qos: prefetch_count->23
[2025-02-19 05:14:22,561: INFO/MainProcess] Task tasks.send_1h_reminder[74fbcd7c-b8b6-423d-add5-b5400bba2eb6] received
[2025-02-19 05:14:22,561: DEBUG/MainProcess] basic.qos: prefetch_count->24
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.phone = ?
 LIMIT ? OFFSET ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00142s] ('79241908281@c.us', 1, 0)
INFO:sqlalchemy.engine.Engine:UPDATE clients SET current_state=? WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00123s] ('active', 1)
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT clients.id AS clients_id, clients.phone AS clients_phone, clients.name AS clients_name, clients.current_state AS clients_current_state, clients.next_week_start AS clients_next_week_start, clients.selected_service_id AS clients_selected_service_id, clients.selected_date AS clients_selected_date, clients.selected_master_id AS clients_selected_master_id, clients.parent_service_id AS clients_parent_service_id, clients.selected_service_category AS clients_selected_service_category 
FROM clients 
WHERE clients.id = ?
INFO:sqlalchemy.engine.Engine:[generated in 0.00022s] (1,)
INFO:routes:Сообщение успешно отправлено в чат 79241908281@c.us.
INFO:sqlalchemy.engine.Engine:ROLLBACK
